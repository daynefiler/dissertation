<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>R Code | Tools and statistical approaches for integrating DNA sequencing into clinical care</title>
  <meta name="description" content="Dissertation by Dayne Filer for the degree of Doctorate of Philosophy in the UNC School of Medicine Curriculum in Bioinformatics and Computational Biology." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="R Code | Tools and statistical approaches for integrating DNA sequencing into clinical care" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://daynefiler.com/dissertation/_book/" />
  
  <meta property="og:description" content="Dissertation by Dayne Filer for the degree of Doctorate of Philosophy in the UNC School of Medicine Curriculum in Bioinformatics and Computational Biology." />
  <meta name="github-repo" content="daynefiler/dissertation" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="R Code | Tools and statistical approaches for integrating DNA sequencing into clinical care" />
  
  <meta name="twitter:description" content="Dissertation by Dayne Filer for the degree of Doctorate of Philosophy in the UNC School of Medicine Curriculum in Bioinformatics and Computational Biology." />
  

<meta name="author" content="Dayne Lewis Filer" />


<meta name="date" content="2021-01-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="future-directions.html"/>
<link rel="next" href="references.html"/>
<script src="libs/header-attrs-2.8.1/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Front matter</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#copyright"><i class="fa fa-check"></i>Copyright</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#abstract"><i class="fa fa-check"></i>Abstract</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#dedication"><i class="fa fa-check"></i>Dedication</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#preface"><i class="fa fa-check"></i>Preface</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#outline"><i class="fa fa-check"></i><b>1.1</b> Outline</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#humGenPrime"><i class="fa fa-check"></i><b>1.2</b> Human Genetics Primer</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="intro.html"><a href="intro.html#dnaDiscover"><i class="fa fa-check"></i><b>1.2.1</b> Discovery of DNA and the central dogma</a></li>
<li class="chapter" data-level="1.2.2" data-path="intro.html"><a href="intro.html#genVar"><i class="fa fa-check"></i><b>1.2.2</b> Genetic variation in humans</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#sequencing"><i class="fa fa-check"></i><b>1.3</b> DNA Sequencing</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="intro.html"><a href="intro.html#firstGen"><i class="fa fa-check"></i><b>1.3.1</b> First-generation sequencing</a></li>
<li class="chapter" data-level="1.3.2" data-path="intro.html"><a href="intro.html#secGen"><i class="fa fa-check"></i><b>1.3.2</b> Second-generation sequencing</a></li>
<li class="chapter" data-level="1.3.3" data-path="intro.html"><a href="intro.html#illumina"><i class="fa fa-check"></i><b>1.3.3</b> Illumina sequencing</a></li>
<li class="chapter" data-level="1.3.4" data-path="intro.html"><a href="intro.html#seqData"><i class="fa fa-check"></i><b>1.3.4</b> Processing short-read sequencing data</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#medGen"><i class="fa fa-check"></i><b>1.4</b> Development of Medical Genetics</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#prob"><i class="fa fa-check"></i><b>1.5</b> Rationale</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="mcCNV.html"><a href="mcCNV.html"><i class="fa fa-check"></i><b>2</b> A novel copy number variant algorithm</a>
<ul>
<li class="chapter" data-level="2.1" data-path="mcCNV.html"><a href="mcCNV.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="mcCNV.html"><a href="mcCNV.html#methods"><i class="fa fa-check"></i><b>2.2</b> Methods</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="mcCNV.html"><a href="mcCNV.html#exome-sequencing"><i class="fa fa-check"></i><b>2.2.1</b> Exome sequencing</a></li>
<li class="chapter" data-level="2.2.2" data-path="mcCNV.html"><a href="mcCNV.html#genome-sequencing"><i class="fa fa-check"></i><b>2.2.2</b> Genome sequencing</a></li>
<li class="chapter" data-level="2.2.3" data-path="mcCNV.html"><a href="mcCNV.html#simulating-targeted-sequencing"><i class="fa fa-check"></i><b>2.2.3</b> Simulating targeted sequencing</a></li>
<li class="chapter" data-level="2.2.4" data-path="mcCNV.html"><a href="mcCNV.html#mccnv-algorithm"><i class="fa fa-check"></i><b>2.2.4</b> mcCNV algorithm</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="mcCNV.html"><a href="mcCNV.html#results"><i class="fa fa-check"></i><b>2.3</b> Results</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="mcCNV.html"><a href="mcCNV.html#multiplexed-capture-reduces-inter-sample-variance"><i class="fa fa-check"></i><b>2.3.1</b> Multiplexed capture reduces inter-sample variance</a></li>
<li class="chapter" data-level="2.3.2" data-path="mcCNV.html"><a href="mcCNV.html#multiplexed-capture-provides-controls-for-exomedepth"><i class="fa fa-check"></i><b>2.3.2</b> Multiplexed capture provides controls for ExomeDepth</a></li>
<li class="chapter" data-level="2.3.3" data-path="mcCNV.html"><a href="mcCNV.html#mccnv-exomedepth-perform-comparably-in-simulation-study"><i class="fa fa-check"></i><b>2.3.3</b> mcCNV &amp; ExomeDepth perform comparably in simulation study</a></li>
<li class="chapter" data-level="2.3.4" data-path="mcCNV.html"><a href="mcCNV.html#mccnv-exomedepth-perform-comparably-on-wgs-pool"><i class="fa fa-check"></i><b>2.3.4</b> mcCNV &amp; ExomeDepth perform comparably on WGS pool</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="mcCNV.html"><a href="mcCNV.html#discussion"><i class="fa fa-check"></i><b>2.4</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="cfES.html"><a href="cfES.html"><i class="fa fa-check"></i><b>3</b> Noninvasive prenatal exome sequencing pitfalls</a>
<ul>
<li class="chapter" data-level="3.1" data-path="cfES.html"><a href="cfES.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="cfES.html"><a href="cfES.html#methods-1"><i class="fa fa-check"></i><b>3.2</b> Methods</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="cfES.html"><a href="cfES.html#participant-selection"><i class="fa fa-check"></i><b>3.2.1</b> Participant selection</a></li>
<li class="chapter" data-level="3.2.2" data-path="cfES.html"><a href="cfES.html#exome-sequencing-and-analysis"><i class="fa fa-check"></i><b>3.2.2</b> Exome sequencing and analysis</a></li>
<li class="chapter" data-level="3.2.3" data-path="cfES.html"><a href="cfES.html#genotyping-algorithm"><i class="fa fa-check"></i><b>3.2.3</b> Genotyping algorithm</a></li>
<li class="chapter" data-level="3.2.4" data-path="cfES.html"><a href="cfES.html#data-availability"><i class="fa fa-check"></i><b>3.2.4</b> Data availability</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="cfES.html"><a href="cfES.html#results-1"><i class="fa fa-check"></i><b>3.3</b> Results</a></li>
<li class="chapter" data-level="3.4" data-path="cfES.html"><a href="cfES.html#discussion-1"><i class="fa fa-check"></i><b>3.4</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="future-directions.html"><a href="future-directions.html"><i class="fa fa-check"></i><b>4</b> Future Directions</a>
<ul>
<li class="chapter" data-level="4.1" data-path="future-directions.html"><a href="future-directions.html#fetal-genotyping-project"><i class="fa fa-check"></i><b>4.1</b> Fetal genotyping project</a></li>
<li class="chapter" data-level="4.2" data-path="future-directions.html"><a href="future-directions.html#cnv-validation-proposal"><i class="fa fa-check"></i><b>4.2</b> CNV validation proposal</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="" data-path="r-code.html"><a href="r-code.html"><i class="fa fa-check"></i>R Code</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tools and statistical approaches for integrating DNA sequencing into clinical care</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="r-code" class="section level1 unnumbered">
<h1>R Code</h1>
<!-- This line tells Pandoc to put the references here -->
<p>This appendix contains all of the R code to reproduce the work presented.
Note, I have omitted the lines of code defining captions for figures/tables for formatting purposes.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="r-code.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">knitr.graphics.auto_pdf =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-2"><a href="r-code.html#cb1-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(</span>
<span id="cb1-3"><a href="r-code.html#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">echo      =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-4"><a href="r-code.html#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">warning   =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-5"><a href="r-code.html#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">message   =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-6"><a href="r-code.html#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">error     =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-7"><a href="r-code.html#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">cache     =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-8"><a href="r-code.html#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">fig.align =</span> <span class="st">&quot;center&quot;</span>,</span>
<span id="cb1-9"><a href="r-code.html#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">fig.width =</span> <span class="dv">5</span>,</span>
<span id="cb1-10"><a href="r-code.html#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">fig.height =</span> <span class="dv">4</span>,</span>
<span id="cb1-11"><a href="r-code.html#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">dev.args =</span> <span class="fu">list</span>(<span class="at">pdf =</span> <span class="fu">list</span>(<span class="at">pointsize =</span> <span class="dv">10</span>),</span>
<span id="cb1-12"><a href="r-code.html#cb1-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">png =</span> <span class="fu">list</span>(<span class="at">pointsize =</span> <span class="dv">10</span>)),</span>
<span id="cb1-13"><a href="r-code.html#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">300</span></span>
<span id="cb1-14"><a href="r-code.html#cb1-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-15"><a href="r-code.html#cb1-15" aria-hidden="true" tabindex="-1"></a>tex  <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb1-16"><a href="r-code.html#cb1-16" aria-hidden="true" tabindex="-1"></a>docx <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb1-17"><a href="r-code.html#cb1-17" aria-hidden="true" tabindex="-1"></a>html <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb1-18"><a href="r-code.html#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span>knitr<span class="sc">:::</span><span class="fu">is_latex_output</span>()) {</span>
<span id="cb1-19"><a href="r-code.html#cb1-19" aria-hidden="true" tabindex="-1"></a>    tex <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb1-20"><a href="r-code.html#cb1-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (knitr<span class="sc">:::</span><span class="fu">is_html_output</span>()) {</span>
<span id="cb1-21"><a href="r-code.html#cb1-21" aria-hidden="true" tabindex="-1"></a>        html <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb1-22"><a href="r-code.html#cb1-22" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb1-23"><a href="r-code.html#cb1-23" aria-hidden="true" tabindex="-1"></a>        docx <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb1-24"><a href="r-code.html#cb1-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-25"><a href="r-code.html#cb1-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-26"><a href="r-code.html#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(filer2020A)</span>
<span id="cb1-27"><a href="r-code.html#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(filer2020B)</span>
<span id="cb1-28"><a href="r-code.html#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mcCNV)</span>
<span id="cb1-29"><a href="r-code.html#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xtable)</span>
<span id="cb1-30"><a href="r-code.html#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(eulerr)</span>
<span id="cb1-31"><a href="r-code.html#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dlfUtils)</span>
<span id="cb1-32"><a href="r-code.html#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb1-33"><a href="r-code.html#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb1-34"><a href="r-code.html#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-35"><a href="r-code.html#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-36"><a href="r-code.html#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tufte)</span>
<span id="cb1-37"><a href="r-code.html#cb1-37" aria-hidden="true" tabindex="-1"></a>defOutWid <span class="ot">&lt;-</span> <span class="cf">if</span> (html) <span class="st">&#39;70%&#39;</span> <span class="cf">else</span> <span class="cn">NULL</span></span>
<span id="cb1-38"><a href="r-code.html#cb1-38" aria-hidden="true" tabindex="-1"></a>dblOutWid <span class="ot">&lt;-</span> <span class="cf">if</span> (html) <span class="st">&#39;40%&#39;</span> <span class="cf">else</span> <span class="st">&#39;49%&#39;</span></span>
<span id="cb1-39"><a href="r-code.html#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(subjectMeta)</span>
<span id="cb1-40"><a href="r-code.html#cb1-40" aria-hidden="true" tabindex="-1"></a>poolTbl <span class="ot">&lt;-</span> subjectMeta[ ,</span>
<span id="cb1-41"><a href="r-code.html#cb1-41" aria-hidden="true" tabindex="-1"></a>                       .(<span class="at">N =</span> .N,</span>
<span id="cb1-42"><a href="r-code.html#cb1-42" aria-hidden="true" tabindex="-1"></a>                         <span class="at">medExon =</span> <span class="fu">round</span>(<span class="fu">median</span>(medIntMolCount), <span class="dv">0</span>),</span>
<span id="cb1-43"><a href="r-code.html#cb1-43" aria-hidden="true" tabindex="-1"></a>                         <span class="at">medTotal =</span> <span class="fu">round</span>(<span class="fu">median</span>(totalMolCount), <span class="dv">0</span>),</span>
<span id="cb1-44"><a href="r-code.html#cb1-44" aria-hidden="true" tabindex="-1"></a>                         <span class="at">minTotal =</span> <span class="fu">min</span>(totalMolCount),</span>
<span id="cb1-45"><a href="r-code.html#cb1-45" aria-hidden="true" tabindex="-1"></a>                         <span class="at">maxTotal =</span> <span class="fu">max</span>(totalMolCount),</span>
<span id="cb1-46"><a href="r-code.html#cb1-46" aria-hidden="true" tabindex="-1"></a>                         <span class="at">rsdTotal =</span> <span class="fu">sd</span>(totalMolCount)<span class="sc">/</span><span class="fu">mean</span>(totalMolCount)<span class="sc">*</span><span class="dv">100</span>),</span>
<span id="cb1-47"><a href="r-code.html#cb1-47" aria-hidden="true" tabindex="-1"></a>                       by <span class="ot">=</span> .(pool, capture, multiplexCapture)]</span>
<span id="cb1-48"><a href="r-code.html#cb1-48" aria-hidden="true" tabindex="-1"></a>poolTbl[ , rsdTotal <span class="sc">:</span><span class="er">=</span> <span class="fu">round</span>(rsdTotal, <span class="dv">1</span>)]</span>
<span id="cb1-49"><a href="r-code.html#cb1-49" aria-hidden="true" tabindex="-1"></a>poolTbl[(<span class="sc">!</span>multiplexCapture), pool <span class="sc">:</span><span class="er">=</span> <span class="fu">paste0</span>(pool, <span class="st">&quot;$^</span><span class="sc">\\</span><span class="st">dagger$&quot;</span>)]</span>
<span id="cb1-50"><a href="r-code.html#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(poolTbl[ , .(pool, capture, N, medExon, medTotal, </span>
<span id="cb1-51"><a href="r-code.html#cb1-51" aria-hidden="true" tabindex="-1"></a>                   minTotal, maxTotal, rsdTotal)], </span>
<span id="cb1-52"><a href="r-code.html#cb1-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">row.names =</span> <span class="cn">FALSE</span>, </span>
<span id="cb1-53"><a href="r-code.html#cb1-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="st">&quot;poolSummary&quot;</span>,</span>
<span id="cb1-54"><a href="r-code.html#cb1-54" aria-hidden="true" tabindex="-1"></a>      <span class="at">format.args =</span> <span class="fu">list</span>(<span class="at">big.mark =</span> <span class="st">&quot;,&quot;</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>),</span>
<span id="cb1-55"><a href="r-code.html#cb1-55" aria-hidden="true" tabindex="-1"></a>      <span class="at">booktabs =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-56"><a href="r-code.html#cb1-56" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption.short =</span> <span class="st">&quot;Summary of whole-exome sequencing for CNV project.&quot;</span>,</span>
<span id="cb1-57"><a href="r-code.html#cb1-57" aria-hidden="true" tabindex="-1"></a>      <span class="at">escape =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-58"><a href="r-code.html#cb1-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>()</span>
<span id="cb1-59"><a href="r-code.html#cb1-59" aria-hidden="true" tabindex="-1"></a><span class="do">## Create IC pools</span></span>
<span id="cb1-60"><a href="r-code.html#cb1-60" aria-hidden="true" tabindex="-1"></a>smplSubject <span class="ot">&lt;-</span> <span class="cf">function</span>(poolName, n) {</span>
<span id="cb1-61"><a href="r-code.html#cb1-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data</span>(subjectMeta, <span class="at">envir =</span> <span class="fu">environment</span>())</span>
<span id="cb1-62"><a href="r-code.html#cb1-62" aria-hidden="true" tabindex="-1"></a>  subjectMeta[pool <span class="sc">==</span> poolName, <span class="fu">sample</span>(subject, n, <span class="at">replace =</span> <span class="cn">FALSE</span>)]</span>
<span id="cb1-63"><a href="r-code.html#cb1-63" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-64"><a href="r-code.html#cb1-64" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb1-65"><a href="r-code.html#cb1-65" aria-hidden="true" tabindex="-1"></a>pools <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">replicate</span>(<span class="dv">5</span>, <span class="fu">smplSubject</span>(<span class="st">&quot;NCGENES&quot;</span>, <span class="dv">16</span>), <span class="at">simplify =</span> <span class="cn">FALSE</span>))</span>
<span id="cb1-66"><a href="r-code.html#cb1-66" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pools) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">sprintf</span>(<span class="st">&quot;randNCG_%d&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>))</span>
<span id="cb1-67"><a href="r-code.html#cb1-67" aria-hidden="true" tabindex="-1"></a>pools <span class="ot">&lt;-</span> <span class="fu">c</span>(pools,</span>
<span id="cb1-68"><a href="r-code.html#cb1-68" aria-hidden="true" tabindex="-1"></a>           <span class="fu">with</span>(subjectMeta[pool <span class="sc">!=</span> <span class="st">&quot;NCGENES&quot;</span>], <span class="fu">split</span>(subject, pool)))</span>
<span id="cb1-69"><a href="r-code.html#cb1-69" aria-hidden="true" tabindex="-1"></a><span class="do">## Calculate mean-variance by pool</span></span>
<span id="cb1-70"><a href="r-code.html#cb1-70" aria-hidden="true" tabindex="-1"></a>mnvr <span class="ot">&lt;-</span> <span class="fu">mclapply</span>(pools, subsetCounts, <span class="at">mc.cores =</span> <span class="fu">length</span>(pools))</span>
<span id="cb1-71"><a href="r-code.html#cb1-71" aria-hidden="true" tabindex="-1"></a>mnvr <span class="ot">&lt;-</span> <span class="fu">mclapply</span>(mnvr, calcIntStats, <span class="at">mc.cores =</span> <span class="fu">length</span>(mnvr))</span>
<span id="cb1-72"><a href="r-code.html#cb1-72" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(mnvr)) {</span>
<span id="cb1-73"><a href="r-code.html#cb1-73" aria-hidden="true" tabindex="-1"></a>  mnvr[[i]][ , pool <span class="sc">:</span><span class="er">=</span> <span class="fu">names</span>(mnvr)[i]]</span>
<span id="cb1-74"><a href="r-code.html#cb1-74" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-75"><a href="r-code.html#cb1-75" aria-hidden="true" tabindex="-1"></a>mnvr <span class="ot">&lt;-</span> <span class="fu">rbindlist</span>(mnvr)</span>
<span id="cb1-76"><a href="r-code.html#cb1-76" aria-hidden="true" tabindex="-1"></a><span class="fu">setkey</span>(mnvr, pool); <span class="fu">setcolorder</span>(mnvr)</span>
<span id="cb1-77"><a href="r-code.html#cb1-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-78"><a href="r-code.html#cb1-78" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimate alpha0</span></span>
<span id="cb1-79"><a href="r-code.html#cb1-79" aria-hidden="true" tabindex="-1"></a>alpha0 <span class="ot">&lt;-</span> <span class="fu">mclapply</span>(pools, estAlpha0, <span class="at">mc.cores =</span> <span class="fu">length</span>(pools))</span>
<span id="cb1-80"><a href="r-code.html#cb1-80" aria-hidden="true" tabindex="-1"></a>a0tbl <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">pool =</span> <span class="fu">names</span>(alpha0),</span>
<span id="cb1-81"><a href="r-code.html#cb1-81" aria-hidden="true" tabindex="-1"></a>                    <span class="at">a0 =</span> <span class="fu">sapply</span>(alpha0, <span class="st">&quot;[[&quot;</span>, <span class="st">&quot;a0&quot;</span>),</span>
<span id="cb1-82"><a href="r-code.html#cb1-82" aria-hidden="true" tabindex="-1"></a>                    <span class="at">N =</span> <span class="fu">sapply</span>(alpha0, <span class="st">&quot;[[&quot;</span>, <span class="st">&quot;N&quot;</span>))</span>
<span id="cb1-83"><a href="r-code.html#cb1-83" aria-hidden="true" tabindex="-1"></a>a0tbl[ , aMn <span class="sc">:</span><span class="er">=</span> a0<span class="sc">/</span>N]</span>
<span id="cb1-84"><a href="r-code.html#cb1-84" aria-hidden="true" tabindex="-1"></a>calcRange <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb1-85"><a href="r-code.html#cb1-85" aria-hidden="true" tabindex="-1"></a>  subjectMeta[subject <span class="sc">%in%</span> x,</span>
<span id="cb1-86"><a href="r-code.html#cb1-86" aria-hidden="true" tabindex="-1"></a>              .(<span class="at">mnCount =</span> <span class="fu">min</span>(totalMolCount),</span>
<span id="cb1-87"><a href="r-code.html#cb1-87" aria-hidden="true" tabindex="-1"></a>                <span class="at">mdCount =</span> <span class="fu">median</span>(totalMolCount),</span>
<span id="cb1-88"><a href="r-code.html#cb1-88" aria-hidden="true" tabindex="-1"></a>                <span class="at">mxCount =</span> <span class="fu">max</span>(totalMolCount),</span>
<span id="cb1-89"><a href="r-code.html#cb1-89" aria-hidden="true" tabindex="-1"></a>                <span class="at">rsCount =</span> <span class="fu">sd</span>(totalMolCount)<span class="sc">/</span><span class="fu">mean</span>(totalMolCount)<span class="sc">*</span><span class="dv">100</span>)]</span>
<span id="cb1-90"><a href="r-code.html#cb1-90" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-91"><a href="r-code.html#cb1-91" aria-hidden="true" tabindex="-1"></a>poolCts <span class="ot">&lt;-</span> <span class="fu">lapply</span>(pools, calcRange)</span>
<span id="cb1-92"><a href="r-code.html#cb1-92" aria-hidden="true" tabindex="-1"></a>poolCts <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">names</span>(poolCts), <span class="cf">function</span>(x) poolCts[[x]][ , <span class="at">pool :=</span> x])</span>
<span id="cb1-93"><a href="r-code.html#cb1-93" aria-hidden="true" tabindex="-1"></a>poolCts <span class="ot">&lt;-</span> <span class="fu">rbindlist</span>(poolCts)</span>
<span id="cb1-94"><a href="r-code.html#cb1-94" aria-hidden="true" tabindex="-1"></a>a0tbl <span class="ot">&lt;-</span> <span class="fu">merge</span>(a0tbl, poolCts)</span>
<span id="cb1-95"><a href="r-code.html#cb1-95" aria-hidden="true" tabindex="-1"></a>a0tbl[ , mc <span class="sc">:</span><span class="er">=</span> <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;IDT-IC|rand&quot;</span>, pool)]</span>
<span id="cb1-96"><a href="r-code.html#cb1-96" aria-hidden="true" tabindex="-1"></a>a0tbl[ , idt <span class="sc">:</span><span class="er">=</span> <span class="fu">grepl</span>(<span class="st">&quot;IDT&quot;</span>, pool)]</span>
<span id="cb1-97"><a href="r-code.html#cb1-97" aria-hidden="true" tabindex="-1"></a><span class="fu">pltAlpha0</span>(a0tbl)</span>
<span id="cb1-98"><a href="r-code.html#cb1-98" aria-hidden="true" tabindex="-1"></a>aglPools <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">sprintf</span>(<span class="st">&quot;randNCG_%d&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>), <span class="st">&quot;Pool1&quot;</span>, <span class="st">&quot;Pool2&quot;</span>, <span class="st">&quot;WGS&quot;</span>, <span class="st">&quot;SMA1&quot;</span>, <span class="st">&quot;SMA2&quot;</span>)</span>
<span id="cb1-99"><a href="r-code.html#cb1-99" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(mnvr[pool <span class="sc">%in%</span> aglPools], {</span>
<span id="cb1-100"><a href="r-code.html#cb1-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pltMnVrCont</span>(<span class="at">dat =</span> <span class="fu">as.data.table</span>(<span class="fu">as.list</span>(<span class="fu">environment</span>())),</span>
<span id="cb1-101"><a href="r-code.html#cb1-101" aria-hidden="true" tabindex="-1"></a>              <span class="at">grpVec =</span> <span class="fu">factor</span>(pool, <span class="at">levels =</span> aglPools),</span>
<span id="cb1-102"><a href="r-code.html#cb1-102" aria-hidden="true" tabindex="-1"></a>              <span class="at">colVec =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&#39;darkblue&#39;</span>, <span class="dv">5</span>), <span class="fu">rep</span>(<span class="st">&#39;darkorange&#39;</span>, <span class="dv">5</span>)),</span>
<span id="cb1-103"><a href="r-code.html#cb1-103" aria-hidden="true" tabindex="-1"></a>              <span class="at">lgnd =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-104"><a href="r-code.html#cb1-104" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb1-105"><a href="r-code.html#cb1-105" aria-hidden="true" tabindex="-1"></a>idtPools <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;IDT-MC&quot;</span>, <span class="st">&quot;IDT-IC&quot;</span>, <span class="st">&quot;IDT-RR&quot;</span>)</span>
<span id="cb1-106"><a href="r-code.html#cb1-106" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(mnvr[pool <span class="sc">%in%</span> idtPools], {</span>
<span id="cb1-107"><a href="r-code.html#cb1-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pltMnVrCont</span>(<span class="at">dat =</span> <span class="fu">as.data.table</span>(<span class="fu">as.list</span>(<span class="fu">environment</span>())),</span>
<span id="cb1-108"><a href="r-code.html#cb1-108" aria-hidden="true" tabindex="-1"></a>              <span class="at">grpVec =</span> <span class="fu">factor</span>(pool, <span class="at">levels =</span> idtPools),</span>
<span id="cb1-109"><a href="r-code.html#cb1-109" aria-hidden="true" tabindex="-1"></a>              <span class="at">colVec =</span> <span class="fu">c</span>(<span class="st">&quot;darkorange&quot;</span>, <span class="st">&quot;darkblue&quot;</span>, <span class="st">&quot;darkorange&quot;</span>),</span>
<span id="cb1-110"><a href="r-code.html#cb1-110" aria-hidden="true" tabindex="-1"></a>              <span class="at">lgnd =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-111"><a href="r-code.html#cb1-111" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb1-112"><a href="r-code.html#cb1-112" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(mnvr[pool <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;WGS&quot;</span>, <span class="st">&quot;IDT-RR&quot;</span>)], {</span>
<span id="cb1-113"><a href="r-code.html#cb1-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pltMnVrCont</span>(<span class="at">dat =</span> <span class="fu">as.data.table</span>(<span class="fu">as.list</span>(<span class="fu">environment</span>())),</span>
<span id="cb1-114"><a href="r-code.html#cb1-114" aria-hidden="true" tabindex="-1"></a>              <span class="at">grpVec =</span> <span class="fu">factor</span>(pool, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;WGS&quot;</span>, <span class="st">&quot;IDT-RR&quot;</span>)),</span>
<span id="cb1-115"><a href="r-code.html#cb1-115" aria-hidden="true" tabindex="-1"></a>              <span class="at">colVec =</span> <span class="fu">c</span>(<span class="st">&quot;darkblue&quot;</span>, <span class="st">&quot;darkorange&quot;</span>))</span>
<span id="cb1-116"><a href="r-code.html#cb1-116" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb1-117"><a href="r-code.html#cb1-117" aria-hidden="true" tabindex="-1"></a><span class="fu">pltSubjectStatByPool</span>(<span class="st">&quot;medIntMolCount&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Median count per exon&quot;</span>)</span>
<span id="cb1-118"><a href="r-code.html#cb1-118" aria-hidden="true" tabindex="-1"></a><span class="fu">pltSubjectStatByPool</span>(<span class="st">&quot;nSelected&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Number of controls selected&quot;</span>)</span>
<span id="cb1-119"><a href="r-code.html#cb1-119" aria-hidden="true" tabindex="-1"></a><span class="fu">pltSubjectStatByPool</span>(<span class="st">&quot;propSelected&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Proportion of controls selected&quot;</span>)</span>
<span id="cb1-120"><a href="r-code.html#cb1-120" aria-hidden="true" tabindex="-1"></a><span class="fu">pltSubjectStatByPool</span>(<span class="st">&quot;overallPhi&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Overdispersion (phi)&quot;</span>)</span>
<span id="cb1-121"><a href="r-code.html#cb1-121" aria-hidden="true" tabindex="-1"></a><span class="fu">setkey</span>(subjectMeta, subject)</span>
<span id="cb1-122"><a href="r-code.html#cb1-122" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(subjectCorr)</span>
<span id="cb1-123"><a href="r-code.html#cb1-123" aria-hidden="true" tabindex="-1"></a><span class="fu">setkey</span>(subjectCorr, subject)</span>
<span id="cb1-124"><a href="r-code.html#cb1-124" aria-hidden="true" tabindex="-1"></a>subjectCorr <span class="ot">&lt;-</span> subjectMeta[subjectCorr]</span>
<span id="cb1-125"><a href="r-code.html#cb1-125" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(simRes)</span>
<span id="cb1-126"><a href="r-code.html#cb1-126" aria-hidden="true" tabindex="-1"></a>procSimRes <span class="ot">&lt;-</span> <span class="fu">lapply</span>(simRes, <span class="cf">function</span>(x) <span class="fu">procRes</span>(x<span class="sc">$</span>clpRes))</span>
<span id="cb1-127"><a href="r-code.html#cb1-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-128"><a href="r-code.html#cb1-128" aria-hidden="true" tabindex="-1"></a>simResTbl <span class="ot">&lt;-</span> <span class="fu">lapply</span>(procSimRes,</span>
<span id="cb1-129"><a href="r-code.html#cb1-129" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">function</span>(x) x<span class="sc">$</span>mnDat[ , .(mcc, tpr, fdr), <span class="at">keyby =</span> dep])</span>
<span id="cb1-130"><a href="r-code.html#cb1-130" aria-hidden="true" tabindex="-1"></a>simResTbl <span class="ot">&lt;-</span> <span class="fu">Reduce</span>(merge, simResTbl)</span>
<span id="cb1-131"><a href="r-code.html#cb1-131" aria-hidden="true" tabindex="-1"></a><span class="fu">setnames</span>(simResTbl,</span>
<span id="cb1-132"><a href="r-code.html#cb1-132" aria-hidden="true" tabindex="-1"></a>         <span class="fu">c</span>(<span class="st">&quot;dep&quot;</span>,</span>
<span id="cb1-133"><a href="r-code.html#cb1-133" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;mcMCC&quot;</span>, <span class="st">&quot;mcTPR&quot;</span>, <span class="st">&quot;mcFDR&quot;</span>,  <span class="do">## mcCNV</span></span>
<span id="cb1-134"><a href="r-code.html#cb1-134" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;edMCC&quot;</span>, <span class="st">&quot;edTPR&quot;</span>, <span class="st">&quot;edFDR&quot;</span>,  <span class="do">## ExomeDepthDefault</span></span>
<span id="cb1-135"><a href="r-code.html#cb1-135" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;ebMCC&quot;</span>, <span class="st">&quot;ebTPR&quot;</span>, <span class="st">&quot;ebFDR&quot;</span>)) <span class="do">## ExomeDepthBest</span></span>
<span id="cb1-136"><a href="r-code.html#cb1-136" aria-hidden="true" tabindex="-1"></a><span class="fu">setcolorder</span>(simResTbl,</span>
<span id="cb1-137"><a href="r-code.html#cb1-137" aria-hidden="true" tabindex="-1"></a>            <span class="fu">c</span>(<span class="st">&quot;dep&quot;</span>, <span class="st">&quot;mcMCC&quot;</span>, <span class="st">&quot;edMCC&quot;</span>, <span class="st">&quot;ebMCC&quot;</span>, <span class="st">&quot;mcTPR&quot;</span>,</span>
<span id="cb1-138"><a href="r-code.html#cb1-138" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;edTPR&quot;</span>, <span class="st">&quot;ebTPR&quot;</span>, <span class="st">&quot;mcFDR&quot;</span>, <span class="st">&quot;edFDR&quot;</span>, <span class="st">&quot;ebFDR&quot;</span>))</span>
<span id="cb1-139"><a href="r-code.html#cb1-139" aria-hidden="true" tabindex="-1"></a>simResTbl <span class="ot">&lt;-</span> simResTbl[ , <span class="fu">lapply</span>(.SD, signif, <span class="dv">3</span>), by <span class="ot">=</span> dep]</span>
<span id="cb1-140"><a href="r-code.html#cb1-140" aria-hidden="true" tabindex="-1"></a><span class="fu">pltStatCompare</span>(<span class="at">xRes =</span> procSimRes<span class="sc">$</span>ExomeDepthDefault, <span class="at">yRes =</span> procSimRes<span class="sc">$</span>mcCNV,</span>
<span id="cb1-141"><a href="r-code.html#cb1-141" aria-hidden="true" tabindex="-1"></a>               <span class="at">stat =</span> <span class="st">&quot;mcc&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;ExomeDepth (default)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;mcCNV&quot;</span>)</span>
<span id="cb1-142"><a href="r-code.html#cb1-142" aria-hidden="true" tabindex="-1"></a><span class="fu">addfiglab</span>(<span class="st">&quot;A&quot;</span>)</span>
<span id="cb1-143"><a href="r-code.html#cb1-143" aria-hidden="true" tabindex="-1"></a><span class="fu">pltStatCompare</span>(<span class="at">xRes =</span> procSimRes<span class="sc">$</span>ExomeDepthDefault, <span class="at">yRes =</span> procSimRes<span class="sc">$</span>mcCNV,</span>
<span id="cb1-144"><a href="r-code.html#cb1-144" aria-hidden="true" tabindex="-1"></a>               <span class="at">stat =</span> <span class="st">&quot;tpr&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;ExomeDepth (default)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;mcCNV&quot;</span>)</span>
<span id="cb1-145"><a href="r-code.html#cb1-145" aria-hidden="true" tabindex="-1"></a><span class="fu">addfiglab</span>(<span class="st">&quot;B&quot;</span>)</span>
<span id="cb1-146"><a href="r-code.html#cb1-146" aria-hidden="true" tabindex="-1"></a><span class="fu">pltStatCompare</span>(<span class="at">xRes =</span> procSimRes<span class="sc">$</span>ExomeDepthDefault, <span class="at">yRes =</span> procSimRes<span class="sc">$</span>mcCNV,</span>
<span id="cb1-147"><a href="r-code.html#cb1-147" aria-hidden="true" tabindex="-1"></a>               <span class="at">stat =</span> <span class="st">&quot;fdr&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;ExomeDepth (default)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;mcCNV&quot;</span>)</span>
<span id="cb1-148"><a href="r-code.html#cb1-148" aria-hidden="true" tabindex="-1"></a><span class="fu">addfiglab</span>(<span class="st">&quot;C&quot;</span>)</span>
<span id="cb1-149"><a href="r-code.html#cb1-149" aria-hidden="true" tabindex="-1"></a><span class="fu">pltStatCompare</span>(<span class="at">xRes =</span> procSimRes<span class="sc">$</span>ExomeDepthBest, <span class="at">yRes =</span> procSimRes<span class="sc">$</span>mcCNV,</span>
<span id="cb1-150"><a href="r-code.html#cb1-150" aria-hidden="true" tabindex="-1"></a>               <span class="at">stat =</span> <span class="st">&quot;mcc&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;ExomeDepth (correct)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;mcCNV&quot;</span>)</span>
<span id="cb1-151"><a href="r-code.html#cb1-151" aria-hidden="true" tabindex="-1"></a><span class="fu">addfiglab</span>(<span class="st">&quot;D&quot;</span>)</span>
<span id="cb1-152"><a href="r-code.html#cb1-152" aria-hidden="true" tabindex="-1"></a><span class="fu">pltStatCompare</span>(<span class="at">xRes =</span> procSimRes<span class="sc">$</span>ExomeDepthBest, <span class="at">yRes =</span> procSimRes<span class="sc">$</span>mcCNV,</span>
<span id="cb1-153"><a href="r-code.html#cb1-153" aria-hidden="true" tabindex="-1"></a>               <span class="at">stat =</span> <span class="st">&quot;tpr&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;ExomeDepth (correct)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;mcCNV&quot;</span>)</span>
<span id="cb1-154"><a href="r-code.html#cb1-154" aria-hidden="true" tabindex="-1"></a><span class="fu">addfiglab</span>(<span class="st">&quot;E&quot;</span>)</span>
<span id="cb1-155"><a href="r-code.html#cb1-155" aria-hidden="true" tabindex="-1"></a><span class="fu">pltStatCompare</span>(<span class="at">xRes =</span> procSimRes<span class="sc">$</span>ExomeDepthBest, <span class="at">yRes =</span> procSimRes<span class="sc">$</span>mcCNV,</span>
<span id="cb1-156"><a href="r-code.html#cb1-156" aria-hidden="true" tabindex="-1"></a>               <span class="at">stat =</span> <span class="st">&quot;fdr&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;ExomeDepth (correct)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;mcCNV&quot;</span>)</span>
<span id="cb1-157"><a href="r-code.html#cb1-157" aria-hidden="true" tabindex="-1"></a><span class="fu">addfiglab</span>(<span class="st">&quot;F&quot;</span>)</span>
<span id="cb1-158"><a href="r-code.html#cb1-158" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(simResTbl,</span>
<span id="cb1-159"><a href="r-code.html#cb1-159" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;dep&quot;</span>, <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;mcCNV&quot;</span>, <span class="st">&quot;ED-def&quot;</span>, <span class="st">&quot;ED-sim&quot;</span>), <span class="dv">3</span>)),</span>
<span id="cb1-160"><a href="r-code.html#cb1-160" aria-hidden="true" tabindex="-1"></a>      <span class="at">row.names =</span> <span class="cn">FALSE</span>, </span>
<span id="cb1-161"><a href="r-code.html#cb1-161" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="st">&quot;simResTbl&quot;</span>,</span>
<span id="cb1-162"><a href="r-code.html#cb1-162" aria-hidden="true" tabindex="-1"></a>      <span class="at">format.args =</span> <span class="fu">list</span>(<span class="at">big.mark =</span> <span class="st">&quot;,&quot;</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>),</span>
<span id="cb1-163"><a href="r-code.html#cb1-163" aria-hidden="true" tabindex="-1"></a>      <span class="at">booktabs =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-164"><a href="r-code.html#cb1-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1-165"><a href="r-code.html#cb1-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot; &quot;</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">&quot;MCC&quot;</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">&quot;TPR&quot;</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">&quot;FDR&quot;</span> <span class="ot">=</span> <span class="dv">3</span>))</span>
<span id="cb1-166"><a href="r-code.html#cb1-166" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(wgsPoolCalls)</span>
<span id="cb1-167"><a href="r-code.html#cb1-167" aria-hidden="true" tabindex="-1"></a>mergeAll <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) <span class="fu">merge</span>(x, y, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-168"><a href="r-code.html#cb1-168" aria-hidden="true" tabindex="-1"></a>wgs <span class="ot">&lt;-</span> <span class="fu">Reduce</span>(mergeAll, wgsPoolCalls)</span>
<span id="cb1-169"><a href="r-code.html#cb1-169" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(intAgl)</span>
<span id="cb1-170"><a href="r-code.html#cb1-170" aria-hidden="true" tabindex="-1"></a>xpandInt <span class="ot">&lt;-</span> <span class="cf">function</span>(int, sbjVec) {</span>
<span id="cb1-171"><a href="r-code.html#cb1-171" aria-hidden="true" tabindex="-1"></a>  lst <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">&quot;list&quot;</span>, <span class="at">length =</span> <span class="fu">length</span>(sbjVec))</span>
<span id="cb1-172"><a href="r-code.html#cb1-172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(lst) <span class="ot">&lt;-</span> sbjVec</span>
<span id="cb1-173"><a href="r-code.html#cb1-173" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (s <span class="cf">in</span> sbjVec) {</span>
<span id="cb1-174"><a href="r-code.html#cb1-174" aria-hidden="true" tabindex="-1"></a>    lst[[s]] <span class="ot">&lt;-</span> <span class="fu">copy</span>(int)</span>
<span id="cb1-175"><a href="r-code.html#cb1-175" aria-hidden="true" tabindex="-1"></a>    lst[[s]][ , subject <span class="sc">:</span><span class="er">=</span> s]</span>
<span id="cb1-176"><a href="r-code.html#cb1-176" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-177"><a href="r-code.html#cb1-177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbindlist</span>(lst)</span>
<span id="cb1-178"><a href="r-code.html#cb1-178" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-179"><a href="r-code.html#cb1-179" aria-hidden="true" tabindex="-1"></a>wgsAgl <span class="ot">&lt;-</span> <span class="fu">xpandInt</span>(intAgl, wgs[ , <span class="fu">unique</span>(subject)])</span>
<span id="cb1-180"><a href="r-code.html#cb1-180" aria-hidden="true" tabindex="-1"></a><span class="fu">setkeyv</span>(wgsAgl, <span class="fu">key</span>(wgs))</span>
<span id="cb1-181"><a href="r-code.html#cb1-181" aria-hidden="true" tabindex="-1"></a>wgs <span class="ot">&lt;-</span> wgs[wgsAgl]</span>
<span id="cb1-182"><a href="r-code.html#cb1-182" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(wgsAgl)</span>
<span id="cb1-183"><a href="r-code.html#cb1-183" aria-hidden="true" tabindex="-1"></a>wgs <span class="ot">&lt;-</span> wgs[<span class="sc">!</span>(rlcr),</span>
<span id="cb1-184"><a href="r-code.html#cb1-184" aria-hidden="true" tabindex="-1"></a>           .(<span class="at">mcDup =</span> <span class="sc">!</span><span class="fu">is.na</span>(passFilter) <span class="sc">&amp;</span> CN <span class="sc">&gt;</span> <span class="dv">1</span>,</span>
<span id="cb1-185"><a href="r-code.html#cb1-185" aria-hidden="true" tabindex="-1"></a>             <span class="at">edDup =</span> <span class="sc">!</span><span class="fu">is.na</span>(type) <span class="sc">&amp;</span> type <span class="sc">==</span> <span class="st">&quot;duplication&quot;</span>,</span>
<span id="cb1-186"><a href="r-code.html#cb1-186" aria-hidden="true" tabindex="-1"></a>             <span class="at">wgDup =</span> <span class="sc">!</span><span class="fu">is.na</span>(erds) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(cnvpytor) <span class="sc">&amp;</span> erds <span class="sc">==</span> <span class="st">&quot;dup&quot;</span>,</span>
<span id="cb1-187"><a href="r-code.html#cb1-187" aria-hidden="true" tabindex="-1"></a>             <span class="at">mcDel =</span> <span class="sc">!</span><span class="fu">is.na</span>(passFilter) <span class="sc">&amp;</span> CN <span class="sc">&lt;</span> <span class="dv">1</span>,</span>
<span id="cb1-188"><a href="r-code.html#cb1-188" aria-hidden="true" tabindex="-1"></a>             <span class="at">edDel =</span> <span class="sc">!</span><span class="fu">is.na</span>(type) <span class="sc">&amp;</span> type <span class="sc">==</span> <span class="st">&quot;deletion&quot;</span>,</span>
<span id="cb1-189"><a href="r-code.html#cb1-189" aria-hidden="true" tabindex="-1"></a>             <span class="at">wgDel =</span> <span class="sc">!</span><span class="fu">is.na</span>(erds) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(cnvpytor) <span class="sc">&amp;</span> erds <span class="sc">==</span> <span class="st">&quot;del&quot;</span>),</span>
<span id="cb1-190"><a href="r-code.html#cb1-190" aria-hidden="true" tabindex="-1"></a>           by <span class="ot">=</span> .(subject, seqnames, start, end)]</span>
<span id="cb1-191"><a href="r-code.html#cb1-191" aria-hidden="true" tabindex="-1"></a>wgs[ , mc <span class="sc">:</span><span class="er">=</span> mcDup <span class="sc">|</span> mcDel]</span>
<span id="cb1-192"><a href="r-code.html#cb1-192" aria-hidden="true" tabindex="-1"></a>wgs[ , ed <span class="sc">:</span><span class="er">=</span> edDup <span class="sc">|</span> edDel]</span>
<span id="cb1-193"><a href="r-code.html#cb1-193" aria-hidden="true" tabindex="-1"></a>wgs[ , wg <span class="sc">:</span><span class="er">=</span> wgDup <span class="sc">|</span> wgDel]</span>
<span id="cb1-194"><a href="r-code.html#cb1-194" aria-hidden="true" tabindex="-1"></a><span class="fu">setcolorder</span>(wgs, <span class="fu">c</span>(<span class="fu">key</span>(wgs), <span class="st">&#39;mc&#39;</span>, <span class="st">&#39;ed&#39;</span>, <span class="st">&#39;wg&#39;</span>))</span>
<span id="cb1-195"><a href="r-code.html#cb1-195" aria-hidden="true" tabindex="-1"></a>wgsCallBySbj <span class="ot">&lt;-</span> wgs[ , <span class="fu">lapply</span>(.SD, sum), .SDcols <span class="ot">=</span> is.logical, by <span class="ot">=</span> subject]</span>
<span id="cb1-196"><a href="r-code.html#cb1-196" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(wgsCallBySbj,</span>
<span id="cb1-197"><a href="r-code.html#cb1-197" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;subject&quot;</span>, <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;MC&quot;</span>, <span class="st">&quot;ED&quot;</span>, <span class="st">&quot;WG&quot;</span>), <span class="dv">3</span>)),</span>
<span id="cb1-198"><a href="r-code.html#cb1-198" aria-hidden="true" tabindex="-1"></a>      <span class="at">row.names =</span> <span class="cn">FALSE</span>, </span>
<span id="cb1-199"><a href="r-code.html#cb1-199" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="st">&quot;wgsCallSbj&quot;</span>,</span>
<span id="cb1-200"><a href="r-code.html#cb1-200" aria-hidden="true" tabindex="-1"></a>      <span class="at">format.args =</span> <span class="fu">list</span>(<span class="at">big.mark =</span> <span class="st">&quot;,&quot;</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>),</span>
<span id="cb1-201"><a href="r-code.html#cb1-201" aria-hidden="true" tabindex="-1"></a>      <span class="at">booktabs =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-202"><a href="r-code.html#cb1-202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1-203"><a href="r-code.html#cb1-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot; &quot;</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">&quot;Total&quot;</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">&quot;Duplications&quot;</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">&quot;Deletions&quot;</span> <span class="ot">=</span> <span class="dv">3</span>))</span>
<span id="cb1-204"><a href="r-code.html#cb1-204" aria-hidden="true" tabindex="-1"></a>pmLst <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb1-205"><a href="r-code.html#cb1-205" aria-hidden="true" tabindex="-1"></a>pmLst<span class="sc">$</span>mc <span class="ot">&lt;-</span> <span class="fu">with</span>(wgs, <span class="fu">evalPred</span>(mc, wg))</span>
<span id="cb1-206"><a href="r-code.html#cb1-206" aria-hidden="true" tabindex="-1"></a>pmLst<span class="sc">$</span>ed <span class="ot">&lt;-</span> <span class="fu">with</span>(wgs, <span class="fu">evalPred</span>(ed, wg))</span>
<span id="cb1-207"><a href="r-code.html#cb1-207" aria-hidden="true" tabindex="-1"></a>pmLst<span class="sc">$</span>mcSub <span class="ot">&lt;-</span> <span class="fu">with</span>(wgs[<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;790|851&quot;</span>, subject)], <span class="fu">evalPred</span>(mc, wg))</span>
<span id="cb1-208"><a href="r-code.html#cb1-208" aria-hidden="true" tabindex="-1"></a>pmLst<span class="sc">$</span>edSub <span class="ot">&lt;-</span> <span class="fu">with</span>(wgs[<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;790|851&quot;</span>, subject)], <span class="fu">evalPred</span>(ed, wg))</span>
<span id="cb1-209"><a href="r-code.html#cb1-209" aria-hidden="true" tabindex="-1"></a>pmLst<span class="sc">$</span>mcDup <span class="ot">&lt;-</span> <span class="fu">with</span>(wgs, <span class="fu">evalPred</span>(mcDup, wgDup))</span>
<span id="cb1-210"><a href="r-code.html#cb1-210" aria-hidden="true" tabindex="-1"></a>pmLst<span class="sc">$</span>edDup <span class="ot">&lt;-</span> <span class="fu">with</span>(wgs, <span class="fu">evalPred</span>(edDup, wgDup))</span>
<span id="cb1-211"><a href="r-code.html#cb1-211" aria-hidden="true" tabindex="-1"></a>pmLst<span class="sc">$</span>mcSubDup <span class="ot">&lt;-</span> <span class="fu">with</span>(wgs[<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;790|851&quot;</span>, subject)],</span>
<span id="cb1-212"><a href="r-code.html#cb1-212" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">evalPred</span>(mcDup, wgDup))</span>
<span id="cb1-213"><a href="r-code.html#cb1-213" aria-hidden="true" tabindex="-1"></a>pmLst<span class="sc">$</span>edSubDup <span class="ot">&lt;-</span> <span class="fu">with</span>(wgs[<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;790|851&quot;</span>, subject)],</span>
<span id="cb1-214"><a href="r-code.html#cb1-214" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">evalPred</span>(edDup, wgDup))</span>
<span id="cb1-215"><a href="r-code.html#cb1-215" aria-hidden="true" tabindex="-1"></a>pmLst<span class="sc">$</span>mcDel <span class="ot">&lt;-</span> <span class="fu">with</span>(wgs, <span class="fu">evalPred</span>(mcDel, wgDel))</span>
<span id="cb1-216"><a href="r-code.html#cb1-216" aria-hidden="true" tabindex="-1"></a>pmLst<span class="sc">$</span>edDel <span class="ot">&lt;-</span> <span class="fu">with</span>(wgs, <span class="fu">evalPred</span>(edDel, wgDel))</span>
<span id="cb1-217"><a href="r-code.html#cb1-217" aria-hidden="true" tabindex="-1"></a>pmLst<span class="sc">$</span>mcSubDel <span class="ot">&lt;-</span> <span class="fu">with</span>(wgs[<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;790|851&quot;</span>, subject)],</span>
<span id="cb1-218"><a href="r-code.html#cb1-218" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">evalPred</span>(mcDel, wgDel))</span>
<span id="cb1-219"><a href="r-code.html#cb1-219" aria-hidden="true" tabindex="-1"></a>pmLst<span class="sc">$</span>edSubDel <span class="ot">&lt;-</span> <span class="fu">with</span>(wgs[<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;790|851&quot;</span>, subject)],</span>
<span id="cb1-220"><a href="r-code.html#cb1-220" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">evalPred</span>(edDel, wgDel))</span>
<span id="cb1-221"><a href="r-code.html#cb1-221" aria-hidden="true" tabindex="-1"></a>predMetrics <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(<span class="fu">do.call</span>(rbind, pmLst), <span class="at">keep.rownames =</span> <span class="st">&quot;PredSet&quot;</span>)</span>
<span id="cb1-222"><a href="r-code.html#cb1-222" aria-hidden="true" tabindex="-1"></a>predMetrics[ , typ <span class="sc">:</span><span class="er">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;ALL&quot;</span>, <span class="st">&quot;DUP&quot;</span>, <span class="st">&quot;DEL&quot;</span>), <span class="at">each =</span> <span class="dv">4</span>)]</span>
<span id="cb1-223"><a href="r-code.html#cb1-223" aria-hidden="true" tabindex="-1"></a>predMetrics[ , set <span class="sc">:</span><span class="er">=</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;Sub&quot;</span>, PredSet), <span class="st">&quot;Sub&quot;</span>, <span class="st">&quot;Total&quot;</span>)]</span>
<span id="cb1-224"><a href="r-code.html#cb1-224" aria-hidden="true" tabindex="-1"></a>predMetrics[ , alg <span class="sc">:</span><span class="er">=</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;mc&quot;</span>, PredSet), <span class="st">&quot;MC&quot;</span>, <span class="st">&quot;ED&quot;</span>)]</span>
<span id="cb1-225"><a href="r-code.html#cb1-225" aria-hidden="true" tabindex="-1"></a><span class="fu">setcolorder</span>(predMetrics, <span class="fu">c</span>(<span class="st">&quot;typ&quot;</span>, <span class="st">&quot;set&quot;</span>, <span class="st">&quot;alg&quot;</span>))</span>
<span id="cb1-226"><a href="r-code.html#cb1-226" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(predMetrics[ , .(typ, set, alg, MCC, TPR, FDR, PPV)],</span>
<span id="cb1-227"><a href="r-code.html#cb1-227" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;&quot;</span>, <span class="dv">3</span>), <span class="st">&quot;MCC&quot;</span>, <span class="st">&quot;TPR&quot;</span>, <span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;PPV&quot;</span>),</span>
<span id="cb1-228"><a href="r-code.html#cb1-228" aria-hidden="true" tabindex="-1"></a>      <span class="at">row.names =</span> <span class="cn">FALSE</span>, </span>
<span id="cb1-229"><a href="r-code.html#cb1-229" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="st">&quot;predMet&quot;</span>,</span>
<span id="cb1-230"><a href="r-code.html#cb1-230" aria-hidden="true" tabindex="-1"></a>      <span class="at">format.args =</span> <span class="fu">list</span>(<span class="at">big.mark =</span> <span class="st">&quot;,&quot;</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>),</span>
<span id="cb1-231"><a href="r-code.html#cb1-231" aria-hidden="true" tabindex="-1"></a>      <span class="at">booktabs =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-232"><a href="r-code.html#cb1-232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1-233"><a href="r-code.html#cb1-233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collapse_rows</span>(<span class="at">columns =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">valign =</span> <span class="st">&quot;middle&quot;</span>)</span>
<span id="cb1-234"><a href="r-code.html#cb1-234" aria-hidden="true" tabindex="-1"></a>ctsAll <span class="ot">&lt;-</span> <span class="fu">euler</span>(wgs[ , .(mc, ed, wg)])</span>
<span id="cb1-235"><a href="r-code.html#cb1-235" aria-hidden="true" tabindex="-1"></a>ctsSub <span class="ot">&lt;-</span> <span class="fu">euler</span>(wgs[<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;790|851&quot;</span>, subject), .(mc, ed, wg)])</span>
<span id="cb1-236"><a href="r-code.html#cb1-236" aria-hidden="true" tabindex="-1"></a>ctsAllDup <span class="ot">&lt;-</span> <span class="fu">euler</span>(wgs[ , .(mcDup, edDup, wgDup)])</span>
<span id="cb1-237"><a href="r-code.html#cb1-237" aria-hidden="true" tabindex="-1"></a>ctsSubDup <span class="ot">&lt;-</span> <span class="fu">euler</span>(wgs[<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;790|851&quot;</span>, subject), .(mcDup, edDup, wgDup)])</span>
<span id="cb1-238"><a href="r-code.html#cb1-238" aria-hidden="true" tabindex="-1"></a>ctsAllDel <span class="ot">&lt;-</span> <span class="fu">euler</span>(wgs[ , .(mcDel, edDel, wgDel)])</span>
<span id="cb1-239"><a href="r-code.html#cb1-239" aria-hidden="true" tabindex="-1"></a>ctsSubDel <span class="ot">&lt;-</span> <span class="fu">euler</span>(wgs[<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;790|851&quot;</span>, subject), .(mcDel, edDel, wgDel)])</span>
<span id="cb1-240"><a href="r-code.html#cb1-240" aria-hidden="true" tabindex="-1"></a><span class="fu">eulerr_options</span>(<span class="at">fills =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;#E9E9E9&quot;</span>, <span class="st">&quot;#7F7FC4&quot;</span>, <span class="st">&quot;#FFC57F&quot;</span>)),</span>
<span id="cb1-241"><a href="r-code.html#cb1-241" aria-hidden="true" tabindex="-1"></a>               <span class="at">quantities =</span> <span class="fu">list</span>(<span class="at">cex =</span> <span class="fl">0.5</span>))</span>
<span id="cb1-242"><a href="r-code.html#cb1-242" aria-hidden="true" tabindex="-1"></a>gridFigLab <span class="ot">&lt;-</span> <span class="cf">function</span>(lab) {</span>
<span id="cb1-243"><a href="r-code.html#cb1-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grid.text</span>(lab, <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">font =</span> <span class="dv">2</span>))</span>
<span id="cb1-244"><a href="r-code.html#cb1-244" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-245"><a href="r-code.html#cb1-245" aria-hidden="true" tabindex="-1"></a><span class="fu">eulerr_options</span>(<span class="at">fills =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;#E9E9E9&quot;</span>, <span class="st">&quot;#7F7FC4&quot;</span>, <span class="st">&quot;#FFC57F&quot;</span>)),</span>
<span id="cb1-246"><a href="r-code.html#cb1-246" aria-hidden="true" tabindex="-1"></a>               <span class="at">quantities =</span> <span class="fu">list</span>(<span class="at">cex =</span> <span class="fl">0.5</span>))</span>
<span id="cb1-247"><a href="r-code.html#cb1-247" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ctsAllDup, <span class="at">quantities =</span> <span class="cn">TRUE</span>, <span class="at">labels =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb1-248"><a href="r-code.html#cb1-248" aria-hidden="true" tabindex="-1"></a><span class="fu">gridFigLab</span>(<span class="st">&quot;A&quot;</span>)</span>
<span id="cb1-249"><a href="r-code.html#cb1-249" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.text</span>(<span class="st">&quot;DUPLICATIONS&quot;</span>, <span class="at">x =</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="fl">0.9</span>)</span>
<span id="cb1-250"><a href="r-code.html#cb1-250" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ctsAllDel, <span class="at">quantities =</span> <span class="cn">TRUE</span>, <span class="at">labels =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb1-251"><a href="r-code.html#cb1-251" aria-hidden="true" tabindex="-1"></a><span class="fu">gridFigLab</span>(<span class="st">&quot;B&quot;</span>)</span>
<span id="cb1-252"><a href="r-code.html#cb1-252" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.text</span>(<span class="st">&quot;DELETIONS&quot;</span>, <span class="at">x =</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="fl">0.9</span>)</span>
<span id="cb1-253"><a href="r-code.html#cb1-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-254"><a href="r-code.html#cb1-254" aria-hidden="true" tabindex="-1"></a><span class="fu">eulerr_options</span>(<span class="at">fills =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;#E9E9E9&quot;</span>, <span class="st">&quot;#7F7FC4&quot;</span>, <span class="st">&quot;#FFC57F&quot;</span>)),</span>
<span id="cb1-255"><a href="r-code.html#cb1-255" aria-hidden="true" tabindex="-1"></a>               <span class="at">quantities =</span> <span class="fu">list</span>(<span class="at">cex =</span> <span class="fl">0.5</span>))</span>
<span id="cb1-256"><a href="r-code.html#cb1-256" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ctsSubDup, <span class="at">quantities =</span> <span class="cn">TRUE</span>, <span class="at">labels =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb1-257"><a href="r-code.html#cb1-257" aria-hidden="true" tabindex="-1"></a><span class="fu">gridFigLab</span>(<span class="st">&quot;A&quot;</span>)</span>
<span id="cb1-258"><a href="r-code.html#cb1-258" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.text</span>(<span class="st">&quot;DUPLICATIONS&quot;</span>, <span class="at">x =</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="fl">0.9</span>)</span>
<span id="cb1-259"><a href="r-code.html#cb1-259" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ctsSubDel, <span class="at">quantities =</span> <span class="cn">TRUE</span>, <span class="at">labels =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb1-260"><a href="r-code.html#cb1-260" aria-hidden="true" tabindex="-1"></a><span class="fu">gridFigLab</span>(<span class="st">&quot;B&quot;</span>)</span>
<span id="cb1-261"><a href="r-code.html#cb1-261" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.text</span>(<span class="st">&quot;DELETIONS&quot;</span>, <span class="at">x =</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="fl">0.9</span>)</span>
<span id="cb1-262"><a href="r-code.html#cb1-262" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimate maternal-fetal genotypes from cell-free exome sequencing</span></span>
<span id="cb1-263"><a href="r-code.html#cb1-263" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(gt)</span>
<span id="cb1-264"><a href="r-code.html#cb1-264" aria-hidden="true" tabindex="-1"></a>gt[ , udep <span class="sc">:</span><span class="er">=</span> ref <span class="sc">+</span> alt]</span>
<span id="cb1-265"><a href="r-code.html#cb1-265" aria-hidden="true" tabindex="-1"></a>gt[ , use <span class="sc">:</span><span class="er">=</span> udep <span class="sc">&gt;</span> <span class="dv">80</span> <span class="sc">&amp;</span> ref <span class="sc">&gt;</span> <span class="dv">5</span> <span class="sc">&amp;</span> alt <span class="sc">&gt;</span> <span class="dv">5</span>]</span>
<span id="cb1-266"><a href="r-code.html#cb1-266" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="fu">c</span>(<span class="st">&quot;S1&quot;</span>, <span class="st">&quot;S2&quot;</span>, <span class="st">&quot;FES-0034-4&quot;</span>)) {</span>
<span id="cb1-267"><a href="r-code.html#cb1-267" aria-hidden="true" tabindex="-1"></a>  gt[smp <span class="sc">==</span> s <span class="sc">&amp;</span> use,</span>
<span id="cb1-268"><a href="r-code.html#cb1-268" aria-hidden="true" tabindex="-1"></a>     <span class="fu">c</span>(<span class="st">&quot;ff&quot;</span>, <span class="st">&quot;gtCall&quot;</span>, <span class="st">&quot;gtLike&quot;</span>) <span class="sc">:</span><span class="er">=</span> <span class="fu">callSmpl</span>(alt, udep, .N, <span class="fu">median</span>(sdep<span class="sc">/</span>ldep))]</span>
<span id="cb1-269"><a href="r-code.html#cb1-269" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-270"><a href="r-code.html#cb1-270" aria-hidden="true" tabindex="-1"></a><span class="do">## Calculate median read depth &amp; fetal fraction estimates by sample</span></span>
<span id="cb1-271"><a href="r-code.html#cb1-271" aria-hidden="true" tabindex="-1"></a>smry <span class="ot">&lt;-</span> gt[(use), .(<span class="at">md =</span> <span class="fu">median</span>(udep), <span class="at">ff =</span> ff[<span class="dv">1</span>]), by <span class="ot">=</span> smp]</span>
<span id="cb1-272"><a href="r-code.html#cb1-272" aria-hidden="true" tabindex="-1"></a><span class="fu">setkey</span>(smry, smp)</span>
<span id="cb1-273"><a href="r-code.html#cb1-273" aria-hidden="true" tabindex="-1"></a><span class="do">## Allele depth histograms</span></span>
<span id="cb1-274"><a href="r-code.html#cb1-274" aria-hidden="true" tabindex="-1"></a><span class="co"># par(oma = c(3, 0, 0, 0), mfrow = c(3, 1))</span></span>
<span id="cb1-275"><a href="r-code.html#cb1-275" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">1</span>), <span class="at">heights =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">10</span>, <span class="dv">3</span>), <span class="dv">1</span>))</span>
<span id="cb1-276"><a href="r-code.html#cb1-276" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(gt[use <span class="sc">&amp;</span> smp <span class="sc">==</span> <span class="st">&quot;S1&quot;</span>], <span class="fu">cfPltFreqHist</span>(alt, udep, gtCall, <span class="at">ff =</span> ff[<span class="dv">1</span>]))</span>
<span id="cb1-277"><a href="r-code.html#cb1-277" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">ylab =</span> <span class="st">&quot;Case 1&quot;</span>, <span class="at">line =</span> <span class="dv">1</span>)</span>
<span id="cb1-278"><a href="r-code.html#cb1-278" aria-hidden="true" tabindex="-1"></a><span class="fu">addfiglab</span>(<span class="st">&quot;A&quot;</span>)</span>
<span id="cb1-279"><a href="r-code.html#cb1-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-280"><a href="r-code.html#cb1-280" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(rs140468248)</span>
<span id="cb1-281"><a href="r-code.html#cb1-281" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(GenoMeta)</span>
<span id="cb1-282"><a href="r-code.html#cb1-282" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(gt[use <span class="sc">&amp;</span> smp <span class="sc">==</span> <span class="st">&quot;S2&quot;</span>], <span class="fu">cfPltFreqHist</span>(alt, udep, gtCall, <span class="at">ff =</span> ff[<span class="dv">1</span>]))</span>
<span id="cb1-283"><a href="r-code.html#cb1-283" aria-hidden="true" tabindex="-1"></a>oiCall <span class="ot">&lt;-</span> gt[varid <span class="sc">==</span> rs140468248, gtCall]</span>
<span id="cb1-284"><a href="r-code.html#cb1-284" aria-hidden="true" tabindex="-1"></a>oiPmar <span class="ot">&lt;-</span> gt[varid <span class="sc">==</span> rs140468248, alt<span class="sc">/</span>(ref <span class="sc">+</span> alt)]</span>
<span id="cb1-285"><a href="r-code.html#cb1-285" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> oiPmar, <span class="at">col =</span> GenoMeta<span class="sc">$</span>color[GenoMeta<span class="sc">$</span>name <span class="sc">==</span> oiCall])</span>
<span id="cb1-286"><a href="r-code.html#cb1-286" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> oiPmar,</span>
<span id="cb1-287"><a href="r-code.html#cb1-287" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> <span class="fu">grconvertY</span>(<span class="fl">0.75</span>, <span class="st">&quot;nfc&quot;</span>),</span>
<span id="cb1-288"><a href="r-code.html#cb1-288" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;rs140468248&quot;</span>,</span>
<span id="cb1-289"><a href="r-code.html#cb1-289" aria-hidden="true" tabindex="-1"></a>     <span class="at">srt =</span> <span class="dv">90</span>,</span>
<span id="cb1-290"><a href="r-code.html#cb1-290" aria-hidden="true" tabindex="-1"></a>     <span class="at">adj =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>),</span>
<span id="cb1-291"><a href="r-code.html#cb1-291" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> GenoMeta<span class="sc">$</span>color[GenoMeta<span class="sc">$</span>name <span class="sc">==</span> oiCall])</span>
<span id="cb1-292"><a href="r-code.html#cb1-292" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">ylab =</span> <span class="st">&quot;Case 2&quot;</span>, <span class="at">line =</span> <span class="dv">1</span>)</span>
<span id="cb1-293"><a href="r-code.html#cb1-293" aria-hidden="true" tabindex="-1"></a><span class="fu">addfiglab</span>(<span class="st">&quot;B&quot;</span>, <span class="at">units =</span> <span class="st">&#39;nfc&#39;</span>)</span>
<span id="cb1-294"><a href="r-code.html#cb1-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-295"><a href="r-code.html#cb1-295" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(gt[use <span class="sc">&amp;</span> smp <span class="sc">==</span> <span class="st">&quot;FES-0034-4&quot;</span>], <span class="fu">cfPltFreqHist</span>(alt, udep, gtCall, <span class="at">ff =</span> ff[<span class="dv">1</span>]))</span>
<span id="cb1-296"><a href="r-code.html#cb1-296" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">ylab =</span> <span class="st">&quot;Case 3&quot;</span>, <span class="at">line =</span> <span class="dv">1</span>)</span>
<span id="cb1-297"><a href="r-code.html#cb1-297" aria-hidden="true" tabindex="-1"></a><span class="fu">addfiglab</span>(<span class="st">&quot;C&quot;</span>, <span class="at">units =</span> <span class="st">&#39;nfc&#39;</span>)</span>
<span id="cb1-298"><a href="r-code.html#cb1-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-299"><a href="r-code.html#cb1-299" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>))</span>
<span id="cb1-300"><a href="r-code.html#cb1-300" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.new</span>()</span>
<span id="cb1-301"><a href="r-code.html#cb1-301" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="fu">grconvertX</span>(<span class="fl">0.5</span>, <span class="at">from =</span> <span class="st">&quot;nfc&quot;</span>),</span>
<span id="cb1-302"><a href="r-code.html#cb1-302" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">grconvertY</span>(<span class="fl">0.5</span>, <span class="at">from =</span> <span class="st">&quot;nfc&quot;</span>),</span>
<span id="cb1-303"><a href="r-code.html#cb1-303" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> GenoMeta<span class="sc">$</span>name,</span>
<span id="cb1-304"><a href="r-code.html#cb1-304" aria-hidden="true" tabindex="-1"></a>       <span class="at">horiz =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-305"><a href="r-code.html#cb1-305" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">4</span>,</span>
<span id="cb1-306"><a href="r-code.html#cb1-306" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> GenoMeta<span class="sc">$</span>color,</span>
<span id="cb1-307"><a href="r-code.html#cb1-307" aria-hidden="true" tabindex="-1"></a>       <span class="at">xjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb1-308"><a href="r-code.html#cb1-308" aria-hidden="true" tabindex="-1"></a>       <span class="at">yjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb1-309"><a href="r-code.html#cb1-309" aria-hidden="true" tabindex="-1"></a>       <span class="at">xpd =</span> <span class="cn">NA</span>,</span>
<span id="cb1-310"><a href="r-code.html#cb1-310" aria-hidden="true" tabindex="-1"></a>       <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb1-311"><a href="r-code.html#cb1-311" aria-hidden="true" tabindex="-1"></a><span class="do">## Collect read depth and filtering information into a table</span></span>
<span id="cb1-312"><a href="r-code.html#cb1-312" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(readSmry)</span>
<span id="cb1-313"><a href="r-code.html#cb1-313" aria-hidden="true" tabindex="-1"></a>rs <span class="ot">&lt;-</span> readSmry<span class="sc">$</span>summary</span>
<span id="cb1-314"><a href="r-code.html#cb1-314" aria-hidden="true" tabindex="-1"></a>rs[ , pctDup <span class="sc">:</span><span class="er">=</span> <span class="fu">round</span>(pctDup, <span class="dv">2</span>)]</span>
<span id="cb1-315"><a href="r-code.html#cb1-315" aria-hidden="true" tabindex="-1"></a>rs[ , pctFlt <span class="sc">:</span><span class="er">=</span> <span class="fu">round</span>(pctFlt, <span class="dv">2</span>)]</span>
<span id="cb1-316"><a href="r-code.html#cb1-316" aria-hidden="true" tabindex="-1"></a><span class="fu">setkey</span>(rs, smp)</span>
<span id="cb1-317"><a href="r-code.html#cb1-317" aria-hidden="true" tabindex="-1"></a>rs <span class="ot">&lt;-</span> smry[rs]</span>
<span id="cb1-318"><a href="r-code.html#cb1-318" aria-hidden="true" tabindex="-1"></a>rs[ , ff <span class="sc">:</span><span class="er">=</span> <span class="fu">round</span>(ff, <span class="dv">3</span>)]</span>
<span id="cb1-319"><a href="r-code.html#cb1-319" aria-hidden="true" tabindex="-1"></a>rs[smp <span class="sc">==</span> <span class="st">&quot;S1&quot;</span>, case <span class="sc">:</span><span class="er">=</span> <span class="st">&quot;Case 1&quot;</span>]</span>
<span id="cb1-320"><a href="r-code.html#cb1-320" aria-hidden="true" tabindex="-1"></a>rs[smp <span class="sc">==</span> <span class="st">&quot;S2&quot;</span>, case <span class="sc">:</span><span class="er">=</span> <span class="st">&quot;Case 2&quot;</span>]</span>
<span id="cb1-321"><a href="r-code.html#cb1-321" aria-hidden="true" tabindex="-1"></a>rs[<span class="fu">grepl</span>(<span class="st">&quot;FES&quot;</span>, smp), case <span class="sc">:</span><span class="er">=</span> <span class="st">&quot;Case 3&quot;</span>]</span>
<span id="cb1-322"><a href="r-code.html#cb1-322" aria-hidden="true" tabindex="-1"></a>caseSmry <span class="ot">&lt;-</span> rs[<span class="sc">!</span><span class="fu">is.na</span>(ff)][<span class="fu">order</span>(case)][ , {</span>
<span id="cb1-323"><a href="r-code.html#cb1-323" aria-hidden="true" tabindex="-1"></a>  .(<span class="at">GA =</span> <span class="fu">sprintf</span>(<span class="st">&#39;(ref:case%dga)&#39;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>),</span>
<span id="cb1-324"><a href="r-code.html#cb1-324" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Clinical findings</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">&#39;(ref:case%dcc)&#39;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>),</span>
<span id="cb1-325"><a href="r-code.html#cb1-325" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Genetic diagnosis</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">&#39;(ref:case%dgd)&#39;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>),</span>
<span id="cb1-326"><a href="r-code.html#cb1-326" aria-hidden="true" tabindex="-1"></a>    <span class="at">FF =</span> ff, </span>
<span id="cb1-327"><a href="r-code.html#cb1-327" aria-hidden="true" tabindex="-1"></a>    <span class="at">Dep =</span> md, </span>
<span id="cb1-328"><a href="r-code.html#cb1-328" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">%Dup</span><span class="st">`</span> <span class="ot">=</span> pctDup, </span>
<span id="cb1-329"><a href="r-code.html#cb1-329" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">%Filt</span><span class="st">`</span> <span class="ot">=</span> pctFlt)</span>
<span id="cb1-330"><a href="r-code.html#cb1-330" aria-hidden="true" tabindex="-1"></a>}]</span>
<span id="cb1-331"><a href="r-code.html#cb1-331" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(caseSmry, </span>
<span id="cb1-332"><a href="r-code.html#cb1-332" aria-hidden="true" tabindex="-1"></a>      <span class="at">row.names =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-333"><a href="r-code.html#cb1-333" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="st">&quot;caseSmry&quot;</span>,</span>
<span id="cb1-334"><a href="r-code.html#cb1-334" aria-hidden="true" tabindex="-1"></a>      <span class="at">format.args =</span> <span class="fu">list</span>(<span class="at">big.mark =</span> <span class="st">&quot;,&quot;</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>),</span>
<span id="cb1-335"><a href="r-code.html#cb1-335" aria-hidden="true" tabindex="-1"></a>      <span class="at">booktabs =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-336"><a href="r-code.html#cb1-336" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption.short =</span> <span class="st">&quot;Cell-free exome sequencing case summaries&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-337"><a href="r-code.html#cb1-337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1-338"><a href="r-code.html#cb1-338" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">width =</span> <span class="st">&quot;10em&quot;</span>)</span>
<span id="cb1-339"><a href="r-code.html#cb1-339" aria-hidden="true" tabindex="-1"></a><span class="do">## Load c3MatFetReads</span></span>
<span id="cb1-340"><a href="r-code.html#cb1-340" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(c3MatFetReads)</span>
<span id="cb1-341"><a href="r-code.html#cb1-341" aria-hidden="true" tabindex="-1"></a><span class="do">## Calculate density and ECDF for fragment read lengths</span></span>
<span id="cb1-342"><a href="r-code.html#cb1-342" aria-hidden="true" tabindex="-1"></a>matDen <span class="ot">&lt;-</span> <span class="fu">density</span>(c3MatFetReads[source <span class="sc">==</span> <span class="st">&quot;maternal&quot;</span>, isize])</span>
<span id="cb1-343"><a href="r-code.html#cb1-343" aria-hidden="true" tabindex="-1"></a>fetDen <span class="ot">&lt;-</span> <span class="fu">density</span>(c3MatFetReads[source <span class="sc">==</span> <span class="st">&quot;fetal&quot;</span>,    isize])</span>
<span id="cb1-344"><a href="r-code.html#cb1-344" aria-hidden="true" tabindex="-1"></a>matCdf <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(c3MatFetReads[source <span class="sc">==</span> <span class="st">&quot;maternal&quot;</span>, isize])</span>
<span id="cb1-345"><a href="r-code.html#cb1-345" aria-hidden="true" tabindex="-1"></a>fetCdf <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(c3MatFetReads[source <span class="sc">==</span> <span class="st">&quot;fetal&quot;</span>,    isize])</span>
<span id="cb1-346"><a href="r-code.html#cb1-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-347"><a href="r-code.html#cb1-347" aria-hidden="true" tabindex="-1"></a><span class="do">## Generate plots</span></span>
<span id="cb1-348"><a href="r-code.html#cb1-348" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb1-349"><a href="r-code.html#cb1-349" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb1-350"><a href="r-code.html#cb1-350" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.new</span>()</span>
<span id="cb1-351"><a href="r-code.html#cb1-351" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.window</span>(<span class="at">xlim =</span> <span class="fu">range</span>(<span class="fu">c</span>(matDen<span class="sc">$</span>x, fetDen<span class="sc">$</span>x)), <span class="fu">range</span>(<span class="fu">c</span>(matDen<span class="sc">$</span>y, fetDen<span class="sc">$</span>y)))</span>
<span id="cb1-352"><a href="r-code.html#cb1-352" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(matDen, <span class="at">col =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb1-353"><a href="r-code.html#cb1-353" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(fetDen, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span><span class="dv">2</span>)</span>
<span id="cb1-354"><a href="r-code.html#cb1-354" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>)</span>
<span id="cb1-355"><a href="r-code.html#cb1-355" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">xlab =</span> <span class="st">&quot;Fragment length (insert size)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Density&quot;</span>)</span>
<span id="cb1-356"><a href="r-code.html#cb1-356" aria-hidden="true" tabindex="-1"></a><span class="fu">addfiglab</span>(<span class="st">&quot;A&quot;</span>)</span>
<span id="cb1-357"><a href="r-code.html#cb1-357" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.new</span>()</span>
<span id="cb1-358"><a href="r-code.html#cb1-358" aria-hidden="true" tabindex="-1"></a>xv <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">50</span>, <span class="dv">300</span>, <span class="dv">1</span>)</span>
<span id="cb1-359"><a href="r-code.html#cb1-359" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.window</span>(<span class="at">xlim =</span> <span class="fu">range</span>(xv), <span class="at">ylim =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb1-360"><a href="r-code.html#cb1-360" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x =</span> xv, <span class="at">y =</span> <span class="fu">matCdf</span>(xv), <span class="at">col =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb1-361"><a href="r-code.html#cb1-361" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x =</span> xv, <span class="at">y =</span> <span class="fu">fetCdf</span>(xv), <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb1-362"><a href="r-code.html#cb1-362" aria-hidden="true" tabindex="-1"></a><span class="fu">addfiglab</span>(<span class="st">&quot;B&quot;</span>, <span class="at">units =</span> <span class="st">&#39;nfc&#39;</span>)</span>
<span id="cb1-363"><a href="r-code.html#cb1-363" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>)</span>
<span id="cb1-364"><a href="r-code.html#cb1-364" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">2</span>)</span>
<span id="cb1-365"><a href="r-code.html#cb1-365" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">xlab =</span> <span class="st">&quot;Fragment length (insert size)&quot;</span>,</span>
<span id="cb1-366"><a href="r-code.html#cb1-366" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&quot;Cumulative distribution&quot;</span>)</span>
<span id="cb1-367"><a href="r-code.html#cb1-367" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="fu">grconvertX</span>(<span class="fl">0.5</span>, <span class="at">from =</span> <span class="st">&quot;ndc&quot;</span>),</span>
<span id="cb1-368"><a href="r-code.html#cb1-368" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">line2user</span>(<span class="dv">2</span>, <span class="at">side =</span> <span class="dv">1</span>, <span class="at">outer =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-369"><a href="r-code.html#cb1-369" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Maternal&quot;</span>, <span class="st">&quot;Fetal&quot;</span>),</span>
<span id="cb1-370"><a href="r-code.html#cb1-370" aria-hidden="true" tabindex="-1"></a>       <span class="at">horiz =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-371"><a href="r-code.html#cb1-371" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb1-372"><a href="r-code.html#cb1-372" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;darkblue&quot;</span>, <span class="st">&quot;darkorange&quot;</span>),</span>
<span id="cb1-373"><a href="r-code.html#cb1-373" aria-hidden="true" tabindex="-1"></a>       <span class="at">xjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb1-374"><a href="r-code.html#cb1-374" aria-hidden="true" tabindex="-1"></a>       <span class="at">yjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb1-375"><a href="r-code.html#cb1-375" aria-hidden="true" tabindex="-1"></a>       <span class="at">xpd =</span> <span class="cn">NA</span>,</span>
<span id="cb1-376"><a href="r-code.html#cb1-376" aria-hidden="true" tabindex="-1"></a>       <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb1-377"><a href="r-code.html#cb1-377" aria-hidden="true" tabindex="-1"></a>gt[ , pmar <span class="sc">:</span><span class="er">=</span> alt<span class="sc">/</span>(alt <span class="sc">+</span> ref)]</span>
<span id="cb1-378"><a href="r-code.html#cb1-378" aria-hidden="true" tabindex="-1"></a>gt[ , sratio <span class="sc">:</span><span class="er">=</span> sdep<span class="sc">/</span>adep]</span>
<span id="cb1-379"><a href="r-code.html#cb1-379" aria-hidden="true" tabindex="-1"></a>pltSratioByPmar <span class="ot">&lt;-</span> <span class="cf">function</span>(smpNm) {</span>
<span id="cb1-380"><a href="r-code.html#cb1-380" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb1-381"><a href="r-code.html#cb1-381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(gt[gtCall <span class="sc">==</span> <span class="st">&quot;AAab&quot;</span> <span class="sc">&amp;</span> smp <span class="sc">==</span> smpNm], {</span>
<span id="cb1-382"><a href="r-code.html#cb1-382" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(pmar <span class="sc">~</span> sratio,</span>
<span id="cb1-383"><a href="r-code.html#cb1-383" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab =</span> <span class="st">&quot;Proportion of fragments &lt; 140 bp&quot;</span>,</span>
<span id="cb1-384"><a href="r-code.html#cb1-384" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab =</span> <span class="st">&quot;PMAR&quot;</span>,</span>
<span id="cb1-385"><a href="r-code.html#cb1-385" aria-hidden="true" tabindex="-1"></a>         <span class="at">pch =</span> <span class="dv">16</span>,</span>
<span id="cb1-386"><a href="r-code.html#cb1-386" aria-hidden="true" tabindex="-1"></a>         <span class="at">cex =</span> <span class="fl">0.5</span>,</span>
<span id="cb1-387"><a href="r-code.html#cb1-387" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">col2alpha</span>(<span class="st">&#39;darkgray&#39;</span>),</span>
<span id="cb1-388"><a href="r-code.html#cb1-388" aria-hidden="true" tabindex="-1"></a>         <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb1-389"><a href="r-code.html#cb1-389" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb1-390"><a href="r-code.html#cb1-390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(gt[gtCall <span class="sc">==</span> <span class="st">&quot;AAab&quot;</span> <span class="sc">&amp;</span> smp <span class="sc">==</span> smpNm], {</span>
<span id="cb1-391"><a href="r-code.html#cb1-391" aria-hidden="true" tabindex="-1"></a>    <span class="fu">contour</span>(<span class="fu">kde2d</span>(<span class="at">x =</span> sratio, <span class="at">y =</span> pmar, <span class="at">n =</span> <span class="dv">500</span>),</span>
<span id="cb1-392"><a href="r-code.html#cb1-392" aria-hidden="true" tabindex="-1"></a>            <span class="at">nlevels =</span> <span class="dv">25</span>,</span>
<span id="cb1-393"><a href="r-code.html#cb1-393" aria-hidden="true" tabindex="-1"></a>            <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-394"><a href="r-code.html#cb1-394" aria-hidden="true" tabindex="-1"></a>            <span class="at">drawlabels =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-395"><a href="r-code.html#cb1-395" aria-hidden="true" tabindex="-1"></a>            <span class="at">col =</span> <span class="st">&quot;darkblue&quot;</span>)</span>
<span id="cb1-396"><a href="r-code.html#cb1-396" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb1-397"><a href="r-code.html#cb1-397" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-398"><a href="r-code.html#cb1-398" aria-hidden="true" tabindex="-1"></a><span class="fu">pltSratioByPmar</span>(<span class="st">&quot;S1&quot;</span>)</span>
<span id="cb1-399"><a href="r-code.html#cb1-399" aria-hidden="true" tabindex="-1"></a><span class="fu">addfiglab</span>(<span class="st">&quot;A&quot;</span>)</span>
<span id="cb1-400"><a href="r-code.html#cb1-400" aria-hidden="true" tabindex="-1"></a><span class="fu">pltSratioByPmar</span>(<span class="st">&quot;S2&quot;</span>)</span>
<span id="cb1-401"><a href="r-code.html#cb1-401" aria-hidden="true" tabindex="-1"></a><span class="fu">addfiglab</span>(<span class="st">&quot;B&quot;</span>)</span>
<span id="cb1-402"><a href="r-code.html#cb1-402" aria-hidden="true" tabindex="-1"></a><span class="fu">pltSratioByPmar</span>(<span class="st">&quot;FES-0034-4&quot;</span>)</span>
<span id="cb1-403"><a href="r-code.html#cb1-403" aria-hidden="true" tabindex="-1"></a><span class="fu">addfiglab</span>(<span class="st">&quot;C&quot;</span>)</span>
<span id="cb1-404"><a href="r-code.html#cb1-404" aria-hidden="true" tabindex="-1"></a><span class="do">## Calculate call concordance between cell-free and direct for Case 3</span></span>
<span id="cb1-405"><a href="r-code.html#cb1-405" aria-hidden="true" tabindex="-1"></a>c3 <span class="ot">&lt;-</span> gt[(smp <span class="sc">==</span> <span class="st">&quot;FES-0034-0&quot;</span> <span class="sc">&amp;</span> udep <span class="sc">&gt;</span> <span class="dv">30</span> <span class="sc">&amp;</span> gt <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;0/0&quot;</span>, <span class="st">&quot;0/1&quot;</span>, <span class="st">&quot;1/1&quot;</span>)) <span class="sc">|</span></span>
<span id="cb1-406"><a href="r-code.html#cb1-406" aria-hidden="true" tabindex="-1"></a>           (smp <span class="sc">==</span> <span class="st">&quot;FES-0034-1&quot;</span> <span class="sc">&amp;</span> udep <span class="sc">&gt;</span> <span class="dv">30</span> <span class="sc">&amp;</span> gt <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;0/0&quot;</span>, <span class="st">&quot;0/1&quot;</span>, <span class="st">&quot;1/1&quot;</span>)) <span class="sc">|</span></span>
<span id="cb1-407"><a href="r-code.html#cb1-407" aria-hidden="true" tabindex="-1"></a>           (use <span class="sc">&amp;</span> smp <span class="sc">==</span> <span class="st">&quot;FES-0034-4&quot;</span>)]</span>
<span id="cb1-408"><a href="r-code.html#cb1-408" aria-hidden="true" tabindex="-1"></a>c3[ , mrg <span class="sc">:</span><span class="er">=</span> <span class="fu">substr</span>(gtCall, <span class="dv">3</span>, <span class="dv">4</span>)]</span>
<span id="cb1-409"><a href="r-code.html#cb1-409" aria-hidden="true" tabindex="-1"></a>c3[ , mrg <span class="sc">:</span><span class="er">=</span> <span class="fu">c</span>(<span class="st">&quot;0/0&quot;</span>, <span class="st">&quot;0/1&quot;</span>, <span class="st">&quot;1/1&quot;</span>)[<span class="fu">match</span>(mrg, <span class="fu">c</span>(<span class="st">&quot;aa&quot;</span>, <span class="st">&quot;ab&quot;</span>, <span class="st">&quot;bb&quot;</span>))]]</span>
<span id="cb1-410"><a href="r-code.html#cb1-410" aria-hidden="true" tabindex="-1"></a>c3[<span class="fu">is.na</span>(gtCall), mrg <span class="sc">:</span><span class="er">=</span> gt]</span>
<span id="cb1-411"><a href="r-code.html#cb1-411" aria-hidden="true" tabindex="-1"></a>c3 <span class="ot">&lt;-</span> <span class="fu">dcast</span>(c3, varid <span class="sc">~</span> smp, <span class="at">value.var =</span> <span class="st">&quot;mrg&quot;</span>)</span>
<span id="cb1-412"><a href="r-code.html#cb1-412" aria-hidden="true" tabindex="-1"></a><span class="fu">setnames</span>(c3, <span class="fu">c</span>(<span class="st">&quot;varid&quot;</span>, <span class="st">&quot;fet&quot;</span>, <span class="st">&quot;mat&quot;</span>, <span class="st">&quot;cff&quot;</span>))</span>
<span id="cb1-413"><a href="r-code.html#cb1-413" aria-hidden="true" tabindex="-1"></a>c3 <span class="ot">&lt;-</span> c3[ , .N, by <span class="ot">=</span> .(mat, fet, cff)]</span>
<span id="cb1-414"><a href="r-code.html#cb1-414" aria-hidden="true" tabindex="-1"></a><span class="do">## call by call matrix, cell-free calls in columns, fetal in rows</span></span>
<span id="cb1-415"><a href="r-code.html#cb1-415" aria-hidden="true" tabindex="-1"></a>c3FetByCf <span class="ot">&lt;-</span> <span class="fu">dcast</span>(c3[<span class="sc">!</span><span class="fu">is.na</span>(fet) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(cff)], </span>
<span id="cb1-416"><a href="r-code.html#cb1-416" aria-hidden="true" tabindex="-1"></a>                   fet <span class="sc">~</span> cff,</span>
<span id="cb1-417"><a href="r-code.html#cb1-417" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fun.aggregate =</span> sum, </span>
<span id="cb1-418"><a href="r-code.html#cb1-418" aria-hidden="true" tabindex="-1"></a>                   <span class="at">value.var =</span> <span class="st">&quot;N&quot;</span>)</span>
<span id="cb1-419"><a href="r-code.html#cb1-419" aria-hidden="true" tabindex="-1"></a><span class="fu">setkey</span>(c3FetByCf, fet)</span>
<span id="cb1-420"><a href="r-code.html#cb1-420" aria-hidden="true" tabindex="-1"></a><span class="do">## all c3 calls</span></span>
<span id="cb1-421"><a href="r-code.html#cb1-421" aria-hidden="true" tabindex="-1"></a>c3Calls <span class="ot">&lt;-</span> c3[<span class="sc">!</span><span class="fu">is.na</span>(mat) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(fet) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(cff), ][<span class="fu">order</span>(mat, fet, cff)]</span>
<span id="cb1-422"><a href="r-code.html#cb1-422" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(c3FetByCf[ , .(<span class="st">&quot; &quot;</span> <span class="ot">=</span> <span class="st">&quot;Fetal&quot;</span>, <span class="st">&quot; &quot;</span> <span class="ot">=</span> fet, <span class="st">`</span><span class="at">0/0</span><span class="st">`</span>, <span class="st">`</span><span class="at">0/1</span><span class="st">`</span>, <span class="st">`</span><span class="at">1/1</span><span class="st">`</span>)], </span>
<span id="cb1-423"><a href="r-code.html#cb1-423" aria-hidden="true" tabindex="-1"></a>      <span class="at">row.names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-424"><a href="r-code.html#cb1-424" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="st">&quot;c3FetByCf&quot;</span>,</span>
<span id="cb1-425"><a href="r-code.html#cb1-425" aria-hidden="true" tabindex="-1"></a>      <span class="at">format.args =</span> <span class="fu">list</span>(<span class="at">big.mark =</span> <span class="st">&quot;,&quot;</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>),</span>
<span id="cb1-426"><a href="r-code.html#cb1-426" aria-hidden="true" tabindex="-1"></a>      <span class="at">booktabs =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-427"><a href="r-code.html#cb1-427" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption.short =</span> <span class="st">&#39;Case 3 fetal versus cell-free genotype calls.&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-428"><a href="r-code.html#cb1-428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1-429"><a href="r-code.html#cb1-429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collapse_rows</span>(<span class="at">columns =</span> <span class="dv">1</span>, <span class="at">valign =</span> <span class="st">&quot;middle&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-430"><a href="r-code.html#cb1-430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot; &quot;</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">&quot;Cell-free&quot;</span> <span class="ot">=</span> <span class="dv">3</span>))</span>
<span id="cb1-431"><a href="r-code.html#cb1-431" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(c3Calls[ , .(<span class="at">Maternal =</span> mat, <span class="at">Fetal =</span> fet, <span class="st">`</span><span class="at">Cell-free</span><span class="st">`</span> <span class="ot">=</span> cff, N)], </span>
<span id="cb1-432"><a href="r-code.html#cb1-432" aria-hidden="true" tabindex="-1"></a>      <span class="at">row.names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-433"><a href="r-code.html#cb1-433" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="st">&quot;c3Calls&quot;</span>,</span>
<span id="cb1-434"><a href="r-code.html#cb1-434" aria-hidden="true" tabindex="-1"></a>      <span class="at">format.args =</span> <span class="fu">list</span>(<span class="at">big.mark =</span> <span class="st">&quot;,&quot;</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>),</span>
<span id="cb1-435"><a href="r-code.html#cb1-435" aria-hidden="true" tabindex="-1"></a>      <span class="at">booktabs =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-436"><a href="r-code.html#cb1-436" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption.short =</span> <span class="st">&#39;Maternal, fetal, and cell-free genotype calls.&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-437"><a href="r-code.html#cb1-437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1-438"><a href="r-code.html#cb1-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collapse_rows</span>(<span class="at">columns =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">valign =</span> <span class="st">&quot;middle&quot;</span>, <span class="at">latex_hline =</span> <span class="st">&quot;full&quot;</span>) </span>
<span id="cb1-439"><a href="r-code.html#cb1-439" aria-hidden="true" tabindex="-1"></a><span class="fu">pltExpMAF</span>(<span class="dv">500</span>)</span>
<span id="cb1-440"><a href="r-code.html#cb1-440" aria-hidden="true" tabindex="-1"></a><span class="fu">pltMissclass</span>()</span></code></pre></div>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="future-directions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["DLFilerDissertation.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
